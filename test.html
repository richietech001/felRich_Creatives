<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recent Poems</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .poem {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .poem h2 {
            margin: 0;
            font-size: 1.5em;
            color: #333;
        }
        .poem p {
            margin: 5px 0;
            color: #666;
        }
        .poem .content {
            white-space: pre-wrap; /* Preserves line breaks in poem content */
        }
    </style>
</head>
<body>
    <h1>Recent Poems</h1>
    <div id="poems-container"></div>

    <script>
        async function fetchPoems() {
            const url = 'https://lnskhhjxxddscgvwgyxb.supabase.co/rest/v1/poems?select=id,title,author,content,created_at&order=created_at.desc&limit=3';
            const headers = {
                'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxuc2toaGp4eGRkc2NndndneXhiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDU5NTI5MSwiZXhwIjoyMDcwMTcxMjkxfQ.jFYmd8NK-nOQXoshz_c9sgYKWg6hU94gBV0DjkRmlt0',
                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxuc2toaGp4eGRkc2NndndneXhiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDU5NTI5MSwiZXhwIjoyMDcwMTcxMjkxfQ.jFYmd8NK-nOQXoshz_c9sgYKWg6hU94gBV0DjkRmlt0'
            };

            try {
                const response = await fetch(url, { headers });
                const poems = await response.json();
                displayPoems(poems);
            } catch (error) {
                console.error('Error fetching poems:', error);
                document.getElementById('poems-container').innerHTML = '<p>Error loading poems.</p>';
            }
        }

        function displayPoems(poems) {
            const container = document.getElementById('poems-container');
            container.innerHTML = '';
            poems.forEach(poem => {
                const poemElement = document.createElement('div');
                poemElement.className = 'poem';
                poemElement.innerHTML = `
                    <h2>${poem.title}</h2>
                    <p><strong>Author:</strong> ${poem.author}</p>
                    <p><strong>Created:</strong> ${new Date(poem.created_at).toLocaleDateString()}</p>
                    <p class="content">${poem.content}</p>
                `;
                container.appendChild(poemElement);
            });
        }

        // Fetch poems when the page loads
        fetchPoems();
    </script>
</body>
</html>
